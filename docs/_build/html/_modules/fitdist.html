
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>fitdist &#8212; fitdist 0.1.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">fitdist 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for fitdist</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/Users/areich/anaconda/bin/python</span>

<span class="sd">&quot;&quot;&quot;fitdist: Find the continuous probability distribution that best fits a dataset</span>

<span class="sd">.. moduleauthor:: Al Reich &lt;Alfred.Reich@soteradefense.com&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">csv</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="c1">#import statsmodels.api as sm</span>

<span class="c1"># Names of all continuous distributions in scipy.stats</span>
<span class="n">cont_dist_names</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>            <span class="c1"># Alpha continuous random variable</span>
    <span class="s1">&#39;anglit&#39;</span><span class="p">,</span>           <span class="c1"># Anglit continuous random variable</span>
    <span class="s1">&#39;arcsine&#39;</span><span class="p">,</span>          <span class="c1"># Arcsine continuous random variable</span>
    <span class="s1">&#39;beta&#39;</span><span class="p">,</span>             <span class="c1"># Beta continuous random variable</span>
    <span class="s1">&#39;betaprime&#39;</span><span class="p">,</span>        <span class="c1"># Beta prime continuous random variable</span>
    <span class="s1">&#39;bradford&#39;</span><span class="p">,</span>         <span class="c1"># Bradford continuous random variable</span>
    <span class="s1">&#39;burr&#39;</span><span class="p">,</span>             <span class="c1"># Burr continuous random variable</span>
    <span class="s1">&#39;cauchy&#39;</span><span class="p">,</span>           <span class="c1"># Cauchy continuous random variable</span>
    <span class="s1">&#39;chi&#39;</span><span class="p">,</span>              <span class="c1"># Chi continuous random variable</span>
    <span class="s1">&#39;chi2&#39;</span><span class="p">,</span>             <span class="c1"># Chi-squared continuous random variable</span>
    <span class="s1">&#39;cosine&#39;</span><span class="p">,</span>           <span class="c1"># Cosine continuous random variable</span>
    <span class="s1">&#39;dgamma&#39;</span><span class="p">,</span>           <span class="c1"># Double gamma continuous random variable</span>
    <span class="s1">&#39;dweibull&#39;</span><span class="p">,</span>         <span class="c1"># Double Weibull continuous random variable</span>
    <span class="c1">#&#39;erlang&#39;,           # Erlang continuous random variable -------------- Often causes problems (so removed)</span>
    <span class="s1">&#39;expon&#39;</span><span class="p">,</span>            <span class="c1"># Exponential continuous random variable</span>
    <span class="s1">&#39;exponweib&#39;</span><span class="p">,</span>        <span class="c1"># Exponentiated Weibull continuous random variable</span>
    <span class="s1">&#39;exponpow&#39;</span><span class="p">,</span>         <span class="c1"># Exponential power continuous random variable</span>
    <span class="s1">&#39;f&#39;</span><span class="p">,</span>                <span class="c1"># F continuous random variable</span>
    <span class="s1">&#39;fatiguelife&#39;</span><span class="p">,</span>      <span class="c1"># Fatigue-life (Birnbaum-Sanders) continuous random variable</span>
    <span class="s1">&#39;fisk&#39;</span><span class="p">,</span>             <span class="c1"># Fisk continuous random variable</span>
    <span class="s1">&#39;foldcauchy&#39;</span><span class="p">,</span>       <span class="c1"># Folded Cauchy continuous random variable</span>
    <span class="s1">&#39;foldnorm&#39;</span><span class="p">,</span>         <span class="c1"># Folded normal continuous random variable</span>
    <span class="s1">&#39;frechet_r&#39;</span><span class="p">,</span>        <span class="c1"># Frechet right (or Weibull minimum) continuous random variable</span>
    <span class="s1">&#39;frechet_l&#39;</span><span class="p">,</span>        <span class="c1"># Frechet left (or Weibull maximum) continuous random variable</span>
    <span class="s1">&#39;genlogistic&#39;</span><span class="p">,</span>      <span class="c1"># Generalized logistic continuous random variable</span>
    <span class="s1">&#39;genpareto&#39;</span><span class="p">,</span>        <span class="c1"># Generalized Pareto continuous random variable</span>
    <span class="s1">&#39;genexpon&#39;</span><span class="p">,</span>         <span class="c1"># Generalized exponential continuous random variable</span>
    <span class="s1">&#39;genextreme&#39;</span><span class="p">,</span>       <span class="c1"># Generalized extreme value continuous random variable</span>
    <span class="s1">&#39;gausshyper&#39;</span><span class="p">,</span>       <span class="c1"># Gauss hypergeometric continuous random variable</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>            <span class="c1"># Gamma continuous random variable</span>
    <span class="s1">&#39;gengamma&#39;</span><span class="p">,</span>         <span class="c1"># Generalized gamma continuous random variable</span>
    <span class="s1">&#39;genhalflogistic&#39;</span><span class="p">,</span>  <span class="c1"># Generalized half-logistic continuous random variable</span>
    <span class="s1">&#39;gilbrat&#39;</span><span class="p">,</span>          <span class="c1"># Gilbrat continuous random variable</span>
    <span class="s1">&#39;gompertz&#39;</span><span class="p">,</span>         <span class="c1"># Gompertz (or truncated Gumbel) continuous random variable</span>
    <span class="s1">&#39;gumbel_r&#39;</span><span class="p">,</span>         <span class="c1"># Right-skewed Gumbel continuous random variable</span>
    <span class="s1">&#39;gumbel_l&#39;</span><span class="p">,</span>         <span class="c1"># Left-skewed Gumbel continuous random variable</span>
    <span class="s1">&#39;halfcauchy&#39;</span><span class="p">,</span>       <span class="c1"># Half-Cauchy continuous random variable</span>
    <span class="s1">&#39;halflogistic&#39;</span><span class="p">,</span>     <span class="c1"># Half-logistic continuous random variable</span>
    <span class="s1">&#39;halfnorm&#39;</span><span class="p">,</span>         <span class="c1"># Half-normal continuous random variable</span>
    <span class="s1">&#39;hypsecant&#39;</span><span class="p">,</span>        <span class="c1"># Hyperbolic secant continuous random variable</span>
    <span class="s1">&#39;invgamma&#39;</span><span class="p">,</span>         <span class="c1"># Inverted gamma continuous random variable</span>
    <span class="s1">&#39;invgauss&#39;</span><span class="p">,</span>         <span class="c1"># Inverse Gaussian continuous random variable</span>
    <span class="s1">&#39;invweibull&#39;</span><span class="p">,</span>       <span class="c1"># Inverted Weibull continuous random variable</span>
    <span class="s1">&#39;johnsonsb&#39;</span><span class="p">,</span>        <span class="c1"># Johnson SB continuous random variable</span>
    <span class="s1">&#39;johnsonsu&#39;</span><span class="p">,</span>        <span class="c1"># Johnson SU continuous random variable</span>
    <span class="s1">&#39;ksone&#39;</span><span class="p">,</span>            <span class="c1"># General Kolmogorov-Smirnov one-sided test</span>
    <span class="s1">&#39;kstwobign&#39;</span><span class="p">,</span>        <span class="c1"># Kolmogorov-Smirnov two-sided test for large N</span>
    <span class="s1">&#39;laplace&#39;</span><span class="p">,</span>          <span class="c1"># Laplace continuous random variable</span>
    <span class="s1">&#39;logistic&#39;</span><span class="p">,</span>         <span class="c1"># Logistic (or Sech-squared) continuous random variable</span>
    <span class="s1">&#39;loggamma&#39;</span><span class="p">,</span>         <span class="c1"># Log gamma continuous random variable</span>
    <span class="s1">&#39;loglaplace&#39;</span><span class="p">,</span>       <span class="c1"># Log-Laplace continuous random variable</span>
    <span class="s1">&#39;lognorm&#39;</span><span class="p">,</span>          <span class="c1"># Lognormal continuous random variable</span>
    <span class="s1">&#39;lomax&#39;</span><span class="p">,</span>            <span class="c1"># Lomax (Pareto of the second kind) continuous random variable</span>
    <span class="s1">&#39;maxwell&#39;</span><span class="p">,</span>          <span class="c1"># Maxwell continuous random variable</span>
    <span class="s1">&#39;mielke&#39;</span><span class="p">,</span>           <span class="c1"># Mielke&#39;s Beta-Kappa continuous random variable</span>
    <span class="s1">&#39;nakagami&#39;</span><span class="p">,</span>         <span class="c1"># Nakagami continuous random variable</span>
    <span class="s1">&#39;ncx2&#39;</span><span class="p">,</span>             <span class="c1"># Non-central chi-squared continuous random variable</span>
    <span class="s1">&#39;ncf&#39;</span><span class="p">,</span>              <span class="c1"># Non-central F distribution continuous random variable</span>
    <span class="s1">&#39;nct&#39;</span><span class="p">,</span>              <span class="c1"># Non-central Student&#39;s T continuous random variable</span>
    <span class="s1">&#39;norm&#39;</span><span class="p">,</span>             <span class="c1"># Normal continuous random variable</span>
    <span class="s1">&#39;pareto&#39;</span><span class="p">,</span>           <span class="c1"># Pareto continuous random variable</span>
    <span class="s1">&#39;pearson3&#39;</span><span class="p">,</span>         <span class="c1"># Pearson type III continuous random variable</span>
    <span class="s1">&#39;powerlaw&#39;</span><span class="p">,</span>         <span class="c1"># Power-function continuous random variable</span>
    <span class="s1">&#39;powerlognorm&#39;</span><span class="p">,</span>     <span class="c1"># Power log-normal continuous random variable</span>
    <span class="s1">&#39;powernorm&#39;</span><span class="p">,</span>        <span class="c1"># Power normal continuous random variable</span>
    <span class="s1">&#39;rdist&#39;</span><span class="p">,</span>            <span class="c1"># R-distributed continuous random variable</span>
    <span class="s1">&#39;reciprocal&#39;</span><span class="p">,</span>       <span class="c1"># Reciprocal continuous random variable</span>
    <span class="s1">&#39;rayleigh&#39;</span><span class="p">,</span>         <span class="c1"># Rayleigh continuous random variable</span>
    <span class="s1">&#39;rice&#39;</span><span class="p">,</span>             <span class="c1"># Rice continuous random variable</span>
    <span class="s1">&#39;recipinvgauss&#39;</span><span class="p">,</span>    <span class="c1"># Reciprocal inverse Gaussian continuous random variable</span>
    <span class="s1">&#39;semicircular&#39;</span><span class="p">,</span>     <span class="c1"># Semicircular continuous random variable</span>
    <span class="s1">&#39;t&#39;</span><span class="p">,</span>                <span class="c1"># Student&#39;s T continuous random variable</span>
    <span class="s1">&#39;triang&#39;</span><span class="p">,</span>           <span class="c1"># Triangular continuous random variable</span>
    <span class="s1">&#39;truncexpon&#39;</span><span class="p">,</span>       <span class="c1"># Truncated exponential continuous random variable</span>
    <span class="s1">&#39;truncnorm&#39;</span><span class="p">,</span>        <span class="c1"># Truncated normal continuous random variable</span>
    <span class="s1">&#39;tukeylambda&#39;</span><span class="p">,</span>      <span class="c1"># Tukey-Lamdba continuous random variable</span>
    <span class="s1">&#39;uniform&#39;</span><span class="p">,</span>          <span class="c1"># Uniform continuous random variable</span>
    <span class="s1">&#39;vonmises&#39;</span><span class="p">,</span>         <span class="c1"># Von Mises continuous random variable</span>
    <span class="s1">&#39;wald&#39;</span><span class="p">,</span>             <span class="c1"># Wald continuous random variable</span>
    <span class="s1">&#39;weibull_min&#39;</span><span class="p">,</span>      <span class="c1"># Frechet right (or Weibull minimum) continuous random variable</span>
    <span class="s1">&#39;weibull_max&#39;</span><span class="p">,</span>      <span class="c1"># Frechet left (or Weibull maximum) continuous random variable</span>
    <span class="s1">&#39;wrapcauchy&#39;</span>        <span class="c1"># Wrapped Cauchy continuous random variable</span>
<span class="p">)</span>

<span class="c1"># A subset of common distribution names in scipy.stats</span>
<span class="n">common_cont_dist_names</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>            <span class="c1"># Alpha continuous random variable</span>
    <span class="s1">&#39;beta&#39;</span><span class="p">,</span>             <span class="c1"># Beta continuous random variable</span>
    <span class="s1">&#39;cauchy&#39;</span><span class="p">,</span>           <span class="c1"># Cauchy continuous random variable</span>
    <span class="s1">&#39;chi2&#39;</span><span class="p">,</span>             <span class="c1"># Chi-squared continuous random variable</span>
    <span class="s1">&#39;expon&#39;</span><span class="p">,</span>            <span class="c1"># Exponential continuous random variable</span>
    <span class="s1">&#39;exponweib&#39;</span><span class="p">,</span>        <span class="c1"># Exponentiated Weibull continuous random variable</span>
    <span class="s1">&#39;f&#39;</span><span class="p">,</span>                <span class="c1"># F continuous random variable</span>
    <span class="s1">&#39;fatiguelife&#39;</span><span class="p">,</span>      <span class="c1"># Fatigue-life (Birnbaum-Sanders) continuous random variable</span>
    <span class="s1">&#39;genextreme&#39;</span><span class="p">,</span>       <span class="c1"># Generalized extreme value continuous random variable</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>            <span class="c1"># Gamma continuous random variable</span>
    <span class="s1">&#39;laplace&#39;</span><span class="p">,</span>          <span class="c1"># Laplace continuous random variable</span>
    <span class="s1">&#39;lognorm&#39;</span><span class="p">,</span>          <span class="c1"># Lognormal continuous random variable</span>
    <span class="s1">&#39;norm&#39;</span><span class="p">,</span>             <span class="c1"># Normal continuous random variable</span>
    <span class="s1">&#39;powerlognorm&#39;</span><span class="p">,</span>     <span class="c1"># Power log-normal continuous random variable</span>
    <span class="s1">&#39;powernorm&#39;</span><span class="p">,</span>        <span class="c1"># Power normal continuous random variable</span>
    <span class="s1">&#39;t&#39;</span><span class="p">,</span>                <span class="c1"># Student&#39;s T continuous random variable</span>
    <span class="s1">&#39;tukeylambda&#39;</span><span class="p">,</span>      <span class="c1"># Tukey-Lamdba continuous random variable</span>
    <span class="s1">&#39;uniform&#39;</span>           <span class="c1"># Uniform continuous random variable</span>
<span class="p">)</span>


<span class="c1"># The basic mechanism for searching through a list of distribution</span>
<span class="c1"># names for the one that fits best was inspired by a snippet of code</span>
<span class="c1"># posted in the following online Q/A forum question:</span>
<span class="c1"># http://stats.stackexchange.com/questions/74434/kolmogorov-smirnov-test-strange-output</span>
<div class="viewcode-block" id="find_best_fit_distributions"><a class="viewcode-back" href="../fd_doc.html#fitdist.find_best_fit_distributions">[docs]</a><span class="k">def</span> <span class="nf">find_best_fit_distributions</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist_names</span><span class="o">=</span><span class="n">common_cont_dist_names</span><span class="p">,</span>
                                <span class="n">goodness_of_fit_pvalue</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span>
                                <span class="n">drop_dist_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;erlang&#39;</span><span class="p">,),</span>
                                <span class="n">verbose_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">logfilename</span><span class="o">=</span><span class="s1">&#39;bestfitdist.log&#39;</span><span class="p">,</span>
                                <span class="n">ignore_gof</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find the probability distributions that best fit the given data.</span>

<span class="sd">    :Inputs:</span>

<span class="sd">        `data`: The input data in the form of a list or array of floating point numbers.</span>

<span class="sd">        `dist_names`: A list of distribution names as found in scipy.stats (defaults to `common_cont_dist_names`).</span>

<span class="sd">        `goodness_of_fit_pvalue`: The p-value for passing the Kolmogorov-Smirnov GoF test (default is 0.10).</span>

<span class="sd">        `drop_dist_names`: A list of distributions to leave off of considerations (module default is [&quot;erlang&quot;]).</span>

<span class="sd">        `verbose_mode`: A boolean that controls whether verbose output will be used (default is False).</span>

<span class="sd">        `logfilename`: The name of the logging file (default is &quot;bestfitdist.log&quot;).</span>

<span class="sd">        `ignore_gof`: If True, the KS GoF test will be ignored and all results will be output (default is False).</span>

<span class="sd">    :Outputs:</span>

<span class="sd">        A list of best-fit results, sorted on KS GoF p-value (&quot;best&quot; to &quot;worst&quot;), where each result</span>
<span class="sd">        is itself a list consisting of three things:</span>
<span class="sd">           * distribution name (the string used in `scipy.stats`),</span>
<span class="sd">           * tuple of MLE parameter estimates (location &amp; scale, resp., are the last two entries)</span>
<span class="sd">           * p-value for the Kolmogorov-Smirnov goodness-of-fit test</span>

<span class="sd">    :Distributions:</span>

<span class="sd">        The distributions used here are listed below.  Names in **bold** are members of `common_cont_dist_names`.</span>

<span class="sd">        **&#39;alpha&#39;**, &#39;anglit&#39;, &#39;arcsine&#39;, **&#39;beta&#39;**, &#39;betaprime&#39;, &#39;bradford&#39;, &#39;burr&#39;, **&#39;cauchy&#39;**, &#39;chi&#39;,</span>
<span class="sd">        **&#39;chi2&#39;**, &#39;cosine&#39;, &#39;dgamma&#39;, &#39;dweibull&#39;, &#39;erlang&#39;, **&#39;expon&#39;**, **&#39;exponweib&#39;**, &#39;exponpow&#39;, **&#39;f&#39;**,</span>
<span class="sd">        **&#39;fatiguelife&#39;**, &#39;fisk&#39;, &#39;foldcauchy&#39;, &#39;foldnorm&#39;, &#39;frechet_r&#39;, &#39;frechet_l&#39;, &#39;genlogistic&#39;, &#39;genpareto&#39;,</span>
<span class="sd">        &#39;genexpon&#39;, **&#39;genextreme&#39;**, &#39;gausshyper&#39;, **&#39;gamma&#39;**, &#39;gengamma&#39;, &#39;genhalflogistic&#39;, &#39;gilbrat&#39;,</span>
<span class="sd">        &#39;gompertz&#39;, &#39;gumbel_r&#39;, &#39;gumbel_l&#39;, &#39;halfcauchy&#39;, &#39;halflogistic&#39;, &#39;halfnorm&#39;, &#39;hypsecant&#39;, &#39;invgamma&#39;,</span>
<span class="sd">        &#39;invgauss&#39;, &#39;invweibull&#39;, &#39;johnsonsb&#39;, &#39;johnsonsu&#39;, &#39;ksone&#39;, &#39;kstwobign&#39;, **&#39;laplace&#39;**, &#39;logistic&#39;,</span>
<span class="sd">        &#39;loggamma&#39;, &#39;loglaplace&#39;, **&#39;lognorm&#39;**, &#39;lomax&#39;, &#39;maxwell&#39;, &#39;mielke&#39;, &#39;nakagami&#39;, &#39;ncx2&#39;, &#39;ncf&#39;, &#39;nct&#39;,</span>
<span class="sd">        **&#39;norm&#39;**, &#39;pareto&#39;, &#39;pearson3&#39;, &#39;powerlaw&#39;, **&#39;powerlognorm&#39;**, **&#39;powernorm&#39;**, &#39;rdist&#39;, &#39;reciprocal&#39;,</span>
<span class="sd">        &#39;rayleigh&#39;, &#39;rice&#39;, &#39;recipinvgauss&#39;, &#39;semicircular&#39;, **&#39;t&#39;**, &#39;triang&#39;, &#39;truncexpon&#39;, &#39;truncnorm&#39;,</span>
<span class="sd">        **&#39;tukeylambda&#39;**, **&#39;uniform&#39;**, &#39;vonmises&#39;, &#39;wald&#39;, &#39;weibull_min&#39;, &#39;weibull_max&#39;, &#39;wrapcauchy&#39;</span>

<span class="sd">    :Misc:</span>

<span class="sd">        Depending on the dataset, some distributions will encounter convergence issues during MLE fitting.</span>
<span class="sd">        Running `fitdist` with `verbose_mode` set to **True** will aid in finding which distributions have</span>
<span class="sd">        problems. On subsequent runs, the `drop_dist_names` option can be used to remove problem distributions</span>
<span class="sd">        from consideration. The &#39;erlang&#39; distribution has been found to be problematic often, so it is dropped</span>
<span class="sd">        by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">logfilename</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">dist_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dist_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">drop_dist_names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ignore_gof</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;===&gt; Scanning </span><span class="si">%d</span><span class="s1"> distributions, ignoring GoF p-value...&#39;</span><span class="p">,</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">dist_names</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;===&gt; Scanning </span><span class="si">%d</span><span class="s1"> distributions, using GoF p-value..., </span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">dist_names</span><span class="p">),</span> <span class="n">goodness_of_fit_pvalue</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose_mode</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ignore_gof</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scanning </span><span class="si">{}</span><span class="s2"> distributions, ignoring GoF p-value...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist_names</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scanning </span><span class="si">{}</span><span class="s2"> distributions, using GoF pvalue, </span><span class="si">%f</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist_names</span><span class="p">),</span> <span class="n">goodness_of_fit_pvalue</span><span class="p">))</span>
    <span class="n">best_fit_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dist_name</span> <span class="ow">in</span> <span class="n">dist_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose_mode</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">dist_name</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;**** Distribution: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">dist_name</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">dist_name</span><span class="p">)</span>  <span class="c1"># Gets a distribution object by name</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Computes the MLE of the distribution&#39;s parameters</span>
        <span class="c1"># Kolmogorov-Smirnov Goodness-of-Fit</span>
        <span class="n">ks_stat</span><span class="p">,</span> <span class="n">ks_p_value</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist_name</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;       Parameters: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;     KS Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ks_stat</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;       KS P-Value: </span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ks_p_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ks_p_value</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ignore_gof</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ks_p_value</span> <span class="o">&gt;=</span> <span class="n">goodness_of_fit_pvalue</span><span class="p">)):</span>
            <span class="n">best_fit_results</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dist_name</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ks_p_value</span><span class="p">])</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;                   PASS&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;                   FAIL&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">best_fit_results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">result</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_fitted_pdf"><a class="viewcode-back" href="../fd_doc.html#fitdist.make_fitted_pdf">[docs]</a><span class="k">def</span> <span class="nf">make_fitted_pdf</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a scipy.stats distribution and its MLE parameters, return the</span>
<span class="sd">    corresponding probability density function (PDF).</span>

<span class="sd">    :Inputs:</span>

<span class="sd">        `distribution`: Either an **instance** of a scipy.stats continuous distribution</span>
<span class="sd">        or a **string** that corresponds to a scipy.stats distribution</span>

<span class="sd">        `parameters`: A tuple of MLE parameters for the input distribution in the order</span>
<span class="sd">        defined by scipy.stats</span>

<span class="sd">    :Outputs:</span>

<span class="sd">        A probability density function, f, such that f(x) --&gt; y, where x &amp; y are floating point values.</span>

<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; import fitdist as fd</span>
<span class="sd">        &gt;&gt;&gt; normal_pdf = fd.make_fitted_pdf(&#39;norm&#39;,(0.0,1.0))</span>
<span class="sd">        &gt;&gt;&gt; normal_pdf(1.0)</span>
<span class="sd">        &gt;&gt;&gt; 0.24197072451914337</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">distribution</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">num_parameters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_parameters</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Some distributions have 3 or 4 parameters</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">parameters</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">num_parameters</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">num_parameters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There must be at least one parameter.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pdf</span></div>


<div class="viewcode-block" id="make_fitted_ppf"><a class="viewcode-back" href="../fd_doc.html#fitdist.make_fitted_ppf">[docs]</a><span class="k">def</span> <span class="nf">make_fitted_ppf</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a scipy.stats distribution and its MLE parameters, return the</span>
<span class="sd">    corresponding point percentage function (PPF) -- inverse of the CDF.</span>

<span class="sd">    :Inputs:</span>

<span class="sd">        `distribution`: Either an **instance** of a scipy.stats continuous distribution</span>
<span class="sd">        or a **string** that corresponds to a scipy.stats distribution</span>

<span class="sd">        `parameters`: A tuple of MLE parameters for the input distribution in the order</span>
<span class="sd">        defined by scipy.stats</span>

<span class="sd">    :Outputs:</span>

<span class="sd">        An point percentage function (PPF), G, such that G(x) --&gt; y, where x &amp; y are floating point values.</span>
<span class="sd">        Note: The PPF is the inverse Cumulative Distribution Function (CDF)</span>

<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; import fitdist as fd</span>
<span class="sd">        &gt;&gt;&gt; normal_ppf = fd.make_fitted_ppf(&#39;norm&#39;,(0.0,1.0))</span>
<span class="sd">        &gt;&gt;&gt; normal_ppf(0.95)</span>
<span class="sd">        &gt;&gt;&gt; 1.6448536269514722</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">distribution</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">num_parameters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_parameters</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Some distributions have 3 or 4 parameters</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">parameters</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">num_parameters</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">num_parameters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There must be at least one parameter.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ppf</span></div>


<div class="viewcode-block" id="make_fitted_cdf"><a class="viewcode-back" href="../fd_doc.html#fitdist.make_fitted_cdf">[docs]</a><span class="k">def</span> <span class="nf">make_fitted_cdf</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a scipy.stats distribution and its MLE parameters, return the</span>
<span class="sd">    corresponding cumulative distribution function (CDF).</span>

<span class="sd">    :Inputs:</span>

<span class="sd">        `distribution`: Either an **instance** of a scipy.stats continuous distribution</span>
<span class="sd">        or a **string** that corresponds to a scipy.stats distribution</span>

<span class="sd">        `parameters`: A tuple of MLE parameters for the input distribution in the order</span>
<span class="sd">        defined by scipy.stats</span>

<span class="sd">    :Outputs:</span>

<span class="sd">        An cumulative distribution function (CDF), F, such that F(x) --&gt; y, where x &amp; y are floating point values.</span>

<span class="sd">    :Example:</span>

<span class="sd">        &gt;&gt;&gt; import fitdist as fd</span>
<span class="sd">        &gt;&gt;&gt; normal_cdf = fd.make_fitted_cdf(&#39;norm&#39;,(0.0,1.0))</span>
<span class="sd">        &gt;&gt;&gt; normal_cdf(1.645)</span>
<span class="sd">        &gt;&gt;&gt; 0.95001509446087862</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">distribution</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">num_parameters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_parameters</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Some distributions have 3 or 4 parameters</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">parameters</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">num_parameters</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">num_parameters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;There must be at least one parameter.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cdf</span></div>


<div class="viewcode-block" id="best_fit_z_scores"><a class="viewcode-back" href="../fd_doc.html#fitdist.best_fit_z_scores">[docs]</a><span class="k">def</span> <span class="nf">best_fit_z_scores</span><span class="p">(</span><span class="n">best_fit_results</span><span class="p">,</span> <span class="n">fitted_dist_p_value</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                      <span class="n">onesided</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">upper_pvalue</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes the output of *find_best_fit_distributions* and returns confidence intervals</span>
<span class="sd">    for each entry (i.e., distribution specification) in the results.</span>

<span class="sd">    :Inputs:</span>

<span class="sd">        `best_fit_results`: The list of results that is output by *find_best_fit_distributions*</span>

<span class="sd">        `fitted_dist_p_value`: A probability, p, where 1-p is the size of the</span>
<span class="sd">        confidence interval (default is 0.05, i.e., 95% confidence interval).</span>

<span class="sd">        `one_sided`: If True, then the output z-scores will correspond to one-sided</span>
<span class="sd">        confidence intervals, otherwise the z-scores will correspond to two-sided</span>
<span class="sd">        confidence intervals (default is True, i.e., one-sided).</span>

<span class="sd">        `upper_pvalue`: If True, then one-sided, *upper* confidence interval z-scores</span>
<span class="sd">        are returned, otherwise, a *lower* confidence interval z-score is returned</span>
<span class="sd">        (default is True).  Only takes effect when *one-sided* is True.</span>

<span class="sd">    :Outputs:</span>

<span class="sd">        A list of z-scores.  If one sided is True, the list will consist of floating</span>
<span class="sd">        point values, otherwise the list will consist of pairs (tuples) of floating</span>
<span class="sd">        point values, where the first float in each pair is the *lower z-score* and</span>
<span class="sd">        the second float is the *upper z-score*.</span>

<span class="sd">    :Example:</span>

<span class="sd">        TBD</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">z_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">best_fit_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">bf_result</span> <span class="ow">in</span> <span class="n">best_fit_results</span><span class="p">:</span>
            <span class="n">dist_name</span> <span class="o">=</span> <span class="n">bf_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">bf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">dist_name</span><span class="p">)</span>
            <span class="n">dist_ppf</span> <span class="o">=</span> <span class="n">make_fitted_ppf</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>  <span class="c1"># for computing z-scores</span>
            <span class="k">if</span> <span class="n">onesided</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">upper_pvalue</span><span class="p">:</span>
                    <span class="n">fitted_zscore</span> <span class="o">=</span> <span class="n">dist_ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">fitted_dist_p_value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fitted_zscore</span> <span class="o">=</span> <span class="n">dist_ppf</span><span class="p">(</span><span class="n">fitted_dist_p_value</span><span class="p">)</span>
                <span class="n">z_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitted_zscore</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># divide probability evenly between both sides</span>
                <span class="n">lower_zscore</span> <span class="o">=</span> <span class="n">dist_ppf</span><span class="p">(</span><span class="n">fitted_dist_p_value</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="n">upper_zscore</span> <span class="o">=</span> <span class="n">dist_ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">fitted_dist_p_value</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
                <span class="n">z_scores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lower_zscore</span><span class="p">,</span> <span class="n">upper_zscore</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are no best-fit results.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z_scores</span></div>


<div class="viewcode-block" id="write_p_value_table"><a class="viewcode-back" href="../fd_doc.html#fitdist.write_p_value_table">[docs]</a><span class="k">def</span> <span class="nf">write_p_value_table</span><span class="p">(</span><span class="n">path_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;p_value_table.csv&quot;</span><span class="p">,</span>
                        <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">mle_parameter_list</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                        <span class="n">probabilities</span><span class="o">=</span><span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mf">0.995</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;For a given probability distribution, the function writes out a one/two-sided confidence interval table.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">distribution</span>
    <span class="n">dist_ppf</span> <span class="o">=</span> <span class="n">make_fitted_ppf</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">mle_parameter_list</span><span class="p">)</span>
    <span class="n">lower_z_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">upper_z_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">probabilities</span><span class="p">:</span>
        <span class="n">lower_z_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist_ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">prob</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
        <span class="n">upper_z_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist_ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">prob</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Probability&#39;</span><span class="p">:</span> <span class="n">probabilities</span><span class="p">,</span>
                           <span class="s1">&#39;Z_Score_Lower&#39;</span><span class="p">:</span> <span class="n">lower_z_scores</span><span class="p">,</span>
                           <span class="s1">&#39;Z_Score_Upper&#39;</span><span class="p">:</span> <span class="n">upper_z_scores</span>
                           <span class="p">})</span>
    <span class="k">if</span> <span class="n">path_name</span><span class="p">:</span>
        <span class="n">dir_name</span> <span class="o">=</span> <span class="n">path_name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dir_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">full_path_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">full_path_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<span class="c1"># def sunspot_data(describe_sunspot_data=False):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Yearly Sunspot Data -- for test, development, and demonstration purposes.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     if describe_sunspot_data:</span>
<span class="c1">#         print sm.datasets.sunspots.NOTE</span>
<span class="c1">#     sunspots = sm.datasets.sunspots.load_pandas().data</span>
<span class="c1">#     # Jan 1 doesn&#39;t work below.  Why not?</span>
<span class="c1">#     sunspots.index = pd.Index(map(lambda y: datetime.datetime(int(y), 12, 31), sunspots[&#39;YEAR&#39;]))</span>
<span class="c1">#     del sunspots[&#39;YEAR&#39;]</span>
<span class="c1">#     return sunspots</span>


<div class="viewcode-block" id="output_results"><a class="viewcode-back" href="../fd_doc.html#fitdist.output_results">[docs]</a><span class="k">def</span> <span class="nf">output_results</span><span class="p">(</span><span class="n">fitdist_results</span><span class="p">,</span> <span class="n">z_scores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">onesided</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">upper_zscores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">conf_int_size</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                   <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">noheader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_gof</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formats the output of find_best_fit_distributions and resulting confidence intervals into CSV form.</span>

<span class="sd">    :Inputs:</span>

<span class="sd">        `fitdist_results`: The list of results that is output by *find_best_fit_distributions*</span>

<span class="sd">        `z_scores`: The list of results that is output by *best_fit_z_scores* (default is None).</span>

<span class="sd">        `one_sided`: If True, then the output z-scores will correspond to one-sided</span>
<span class="sd">        confidence intervals, otherwise the z-scores will correspond to two-sided</span>
<span class="sd">        confidence intervals (default is True, i.e., one-sided).</span>

<span class="sd">        `fitted_dist_p_value`: A probability, p, where 1-p is the size of the</span>
<span class="sd">        confidence interval (default is 0.05, i.e., 95% confidence interval).</span>

<span class="sd">        `upper_pvalue`: If True, then one-sided, *upper* confidence interval z-scores</span>
<span class="sd">        are returned, otherwise, a *lower* confidence interval z-score is returned</span>
<span class="sd">        (default is True).  Only takes effect when *one-sided* is True.</span>

<span class="sd">        `upper_zscores`: (default is False)</span>

<span class="sd">        `conf_int_size`: (default is 0.95)</span>

<span class="sd">        `delimiter`: (default is &#39;,&#39;)</span>

<span class="sd">        `noheader`: (default is False)</span>

<span class="sd">        `verbose_mode`: (default is True)</span>

<span class="sd">        `ignore_gof`: (default is False)</span>

<span class="sd">        `fitted_dist_p_value`: A probability, p, where 1-p is the size of the</span>
<span class="sd">        confidence interval (default is 0.05, i.e., 95% confidence interval).</span>

<span class="sd">        `one_sided`: If True, then the output z-scores will correspond to one-sided</span>
<span class="sd">        confidence intervals, otherwise the z-scores will correspond to two-sided</span>
<span class="sd">        confidence intervals (default is True, i.e., one-sided).</span>

<span class="sd">        `upper_pvalue`: If True, then one-sided, *upper* confidence interval z-scores</span>
<span class="sd">        are returned, otherwise, a *lower* confidence interval z-score is returned</span>
<span class="sd">        (default is True).  Only takes effect when *one-sided* is True.</span>

<span class="sd">    :Outputs:</span>

<span class="sd">        A list of z-scores.  If one sided is True, the list will consist of floating</span>
<span class="sd">        point values, otherwise the list will consist of pairs (tuples) of floating</span>
<span class="sd">        point values, where the first float in each pair is the *lower z-score* and</span>
<span class="sd">        the second float is the *upper z-score*.</span>

<span class="sd">    :Example:</span>

<span class="sd">        TBD</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose_mode</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ignore_gof</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="s2"> distributions output.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fitdist_results</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="s2"> distributions passed the goodness-of-fit test.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fitdist_results</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here is the best one:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Distribution Name: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">  MLE Parameter Estimates: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fitdist_results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fitdist_results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Here are the fit results that were returned:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">noheader</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;goodness_of_fit&quot;</span><span class="p">,</span> <span class="s2">&quot;lower_z_score&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_z_score&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter0&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter1&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter2&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">z_scores</span><span class="p">:</span>
        <span class="n">z_scores</span> <span class="o">=</span> <span class="n">best_fit_z_scores</span><span class="p">(</span><span class="n">fitdist_results</span><span class="p">,</span> <span class="n">fitted_dist_p_value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">conf_int_size</span><span class="p">),</span>
                                     <span class="n">onesided</span><span class="o">=</span><span class="n">onesided</span><span class="p">,</span> <span class="n">upper_pvalue</span><span class="o">=</span><span class="n">upper_zscores</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z_scores</span><span class="p">,</span> <span class="n">fitdist_results</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">onesided</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">upper_zscores</span><span class="p">:</span>
                <span class="n">lowerz</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">upperz</span> <span class="o">=</span> <span class="n">z_score</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lowerz</span> <span class="o">=</span> <span class="n">z_score</span>
                <span class="n">upperz</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lowerz</span> <span class="o">=</span> <span class="n">z_score</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">upperz</span> <span class="o">=</span> <span class="n">z_score</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">distname</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># Placeholders for remaining parameters, if any</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameters</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
        <span class="n">gof</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">distname</span><span class="p">,</span> <span class="n">gof</span><span class="p">,</span> <span class="n">lowerz</span><span class="p">,</span> <span class="n">upperz</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">ps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ps</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">argparse</span>
    <span class="kn">import</span> <span class="nn">textwrap</span>

    <span class="c1"># PARSE COMMAND LINE ARGUMENTS</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s1">        Find the probability distribution that best-fits a set of data. Eighteen common continuous distributions</span>
<span class="s1">        are examined for a best-fit using the default option, dist=common.  Setting dist=all results in over 80</span>
<span class="s1">        continuous distributions being examined.</span>
<span class="s1">        </span>
<span class="s1">        The Kolmogorov-Smirnov (KS) Goodness-of-Fit (GoF) test is used to determine whether the fit is suitable.</span>
<span class="s1">        If a KS GoF statistic is larger than the input (or default) threshold, fitpval, the distributions passes,</span>
<span class="s1">        otherwise it fails.  For those distributions that pass the following is output: distribution name, list</span>
<span class="s1">        of MLE parameter estimates, and KS GoF p-value.</span>

<span class="s1">        A log file of distribution names, their MLE parameter estimates, the KS GoF statistic and p-value, and</span>
<span class="s1">        whether they pass or fail is always written out (see the logfile option).</span>

<span class="s1">        The following third-party Python modules are required: numpy, scipy.stats, and pandas</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">),</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawDescriptionHelpFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">        Examples:</span>
<span class="s2">            (NOTE: No whitespace is permitted in &#39;drop&#39; lists)</span>
<span class="s2">            python fitdist.py --verbose --drop [</span><span class="se">\\</span><span class="s2">&#39;beta</span><span class="se">\\</span><span class="s2">&#39;,</span><span class="se">\\</span><span class="s2">&#39;ksone</span><span class="se">\\</span><span class="s2">&#39;] mydata.txt    &lt;--input file at end</span>
<span class="s2">            python fitdist.py mydata.txt --verbose --drop [</span><span class="se">\\</span><span class="s2">&#39;beta</span><span class="se">\\</span><span class="s2">,</span><span class="se">\\</span><span class="s2">&#39;ksone</span><span class="se">\\</span><span class="s2">&#39;&#39;]    &lt;--input file at beginning</span>
<span class="s2">            cat mydata.txt | python fitdist.py --drop [</span><span class="se">\\</span><span class="s2">&#39;beta</span><span class="se">\\</span><span class="s2">&#39;,</span><span class="se">\\</span><span class="s2">&#39;ksone</span><span class="se">\\</span><span class="s2">&#39;]        &lt;--stdin</span>
<span class="s2">            python fitdist.py mydata.txt --dist custom --distlist [</span><span class="se">\\</span><span class="s2">&#39;norm</span><span class="se">\\</span><span class="s2">&#39;,</span><span class="se">\\</span><span class="s2">&#39;t</span><span class="se">\\</span><span class="s2">&#39;] --delimiter &#39;,&#39;  &lt;--custom list</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;infile&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of an input file of floats; one float per line, no header. </span><span class="se">\</span>
<span class="s2">                        Leave this name off if using stdin instead.&quot;</span><span class="p">,</span>
                        <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">FileType</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">),</span>
                        <span class="n">default</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--verbose&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Increase output verbosity&quot;</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--dist&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify built-in distribution set to use; default is </span><span class="se">\&#39;</span><span class="s2">common</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;common&#39;</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--distlist&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;List of distributions to use if when the </span><span class="se">\&#39;</span><span class="s1">dist</span><span class="se">\&#39;</span><span class="s1"> option</span>
<span class="s1">                        is </span><span class="se">\&#39;</span><span class="s1">custom</span><span class="se">\&#39;</span><span class="s1">; use the same type of formatting used for the </span><span class="se">\&#39;</span><span class="s1">drop</span><span class="se">\&#39;</span><span class="s1"></span>
<span class="s1">                        option; when using this, the </span><span class="se">\&#39;</span><span class="s1">results</span><span class="se">\&#39;</span><span class="s1"> option is automatically set</span>
<span class="s1">                        to </span><span class="se">\&#39;</span><span class="s1">all</span><span class="se">\&#39;</span><span class="s1">.&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--drop&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;List of distribution names to drop from consideration;</span>
<span class="s1">                        names must be formatted as shown in the examples, below.</span>
<span class="s1">                        WARNING: Whitespace in drop lists is NOT permitted! &#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--results&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;Ignore the </span><span class="se">\&#39;</span><span class="s1">fitpval</span><span class="se">\&#39;</span><span class="s1"> option and output either</span>
<span class="s1">                        all results, or the single best result&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">])</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--delimiter&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;Delimiter to use when writing output results; the default is tabs;</span>
<span class="s1">                        set this option to </span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1"> for commas&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="c1">#default=&#39;,&#39;)</span>
                        <span class="n">default</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--noheader&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Don&#39;t include a header at the start of the output results&quot;</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--logfile&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;Filename to write logging statements to; default is</span>
<span class="s1">                        </span><span class="se">\&quot;</span><span class="s1">bestfitdist.log</span><span class="se">\&quot;</span><span class="s1">&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--fitpval&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;P-value to use for the KS GoF test on distributions;</span>
<span class="s1">                        must be &gt;= 0.0 and &lt; 1.0; default is 0.25;</span>
<span class="s1">                        using 0.0 will output all results.&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--zscores&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;The size of a confidence interval (probability)</span>
<span class="s1">                        to output z-scores for; must be &gt; 0.0 and &lt; 1.0; default is 95</span><span class="si">%%</span><span class="s1">.&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--upper&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;output one-sided, upper z-score; only makes</span>
<span class="s1">                        sense when used with the zscores option; do not use with</span>
<span class="s1">                        </span><span class="se">\&quot;</span><span class="s1">lower</span><span class="se">\&quot;</span><span class="s1"> option&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--lower&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;output one-sided, lower z-score; only makes</span>
<span class="s1">                        sense when used with the zscores option; do not use with</span>
<span class="s1">                        </span><span class="se">\&quot;</span><span class="s1">upper</span><span class="se">\&quot;</span><span class="s1"> option&#39;&#39;&#39;</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># SELECT THE SET OF DISTRIBUTIONS TO USE</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">dist</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;common&#39;</span><span class="p">):</span>  <span class="c1"># DEFAULT OPTION</span>
        <span class="n">dist_name_list</span> <span class="o">=</span> <span class="n">common_cont_dist_names</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">dist_name_list</span> <span class="o">=</span> <span class="n">cont_dist_names</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">distlist</span><span class="p">:</span>
            <span class="n">dist_name_list</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">distlist</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using custom distribution list: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dist_name_list</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">dist</span><span class="se">\&#39;</span><span class="s2"> = </span><span class="se">\&#39;</span><span class="s2">custom</span><span class="se">\&#39;</span><span class="s2">, but no distributions were provided in the </span><span class="se">\&#39;</span><span class="s2">distlist</span><span class="se">\&#39;</span><span class="s2"> option.&quot;</span>
            <span class="k">raise</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentTypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The way argparse is setup, we should never get here, but just in case...</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not an option for selecting the set of distributions&quot;</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">dist</span>
        <span class="k">raise</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentTypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># CHECK IF &#39;RESULTS&#39; IS SET TO &#39;ALL&#39; OR &#39;ONE&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">results</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">):</span>
        <span class="n">results_all</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># pvalue will be ignored in &#39;find_best_fit_distributions&#39;</span>
        <span class="n">results_one</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">results</span> <span class="o">==</span> <span class="s1">&#39;one&#39;</span><span class="p">:</span>
        <span class="n">results_all</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">results_one</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Only the top scoring distribution will be output</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">results_all</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">results_one</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># IF INPUT DATA THEN READ IT</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">infile</span><span class="p">:</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing </span><span class="si">%d</span><span class="s2"> values in file </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">args</span><span class="o">.</span><span class="n">infile</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>

    <span class="c1"># SETUP DISTRIBUTIONS TO DROP FROM CONSIDERATION</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">drop</span><span class="p">:</span>
        <span class="n">drop_names</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">drop</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dropping distributions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">drop_names</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">drop_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dropping distributions: None&quot;</span><span class="p">)</span>

    <span class="c1"># SETUP THE LOGGING FILE</span>
    <span class="n">logfile</span> <span class="o">=</span> <span class="s1">&#39;bestfitdist.log&#39;</span>  <span class="c1"># Default</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="p">:</span>
        <span class="n">logfile</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">logfile</span>

    <span class="c1"># SETUP THE KS GOF P-VALUE</span>
    <span class="n">gof_pvalue</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># Default</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">fitpval</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">fitpval</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">fitpval</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="n">gof_pvalue</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">fitpval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The </span><span class="se">\&#39;</span><span class="s2">fitpval</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">%f</span><span class="s2">, is not strictly between 0.0 and 1.0&quot;</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">fitpval</span><span class="p">)</span>

    <span class="c1"># SETUP Z-SCORES</span>
    <span class="n">zscores_pvalue</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Default (one minus the size of the desired confidence interval)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">zscores</span><span class="p">:</span>
        <span class="k">if</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">args</span><span class="o">.</span><span class="n">zscores</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="c1"># z-scores calc uses tail probs, not the size of the confidence interval</span>
            <span class="n">zscores_pvalue</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">args</span><span class="o">.</span><span class="n">zscores</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The </span><span class="se">\&#39;</span><span class="s2">zscores</span><span class="se">\&#39;</span><span class="s2"> option value, </span><span class="si">%f</span><span class="s2">, is not strictly between 0.0 and 1.0&quot;</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">zscores</span><span class="p">)</span>

    <span class="c1"># DO THE BEST-FIT CALCULATION</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*** FINDING BEST-FIT DISTRIBUTIONS...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fit_results</span> <span class="o">=</span> <span class="n">find_best_fit_distributions</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                                              <span class="n">dist_names</span><span class="o">=</span><span class="n">dist_name_list</span><span class="p">,</span>
                                              <span class="n">goodness_of_fit_pvalue</span><span class="o">=</span><span class="n">gof_pvalue</span><span class="p">,</span>
                                              <span class="n">drop_dist_names</span><span class="o">=</span><span class="n">drop_names</span><span class="p">,</span>
                                              <span class="n">verbose_mode</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
                                              <span class="n">logfilename</span><span class="o">=</span><span class="n">logfile</span><span class="p">,</span>
                                              <span class="n">ignore_gof</span><span class="o">=</span><span class="n">results_all</span><span class="p">)</span>

    <span class="c1"># IF ONLY THE SINGLE BEST FIT IS DESIRED, THEN SELECT ONLY IT</span>
    <span class="k">if</span> <span class="n">results_one</span><span class="p">:</span>
        <span class="n">fit_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="c1"># CALCULATE THE Z-SCORES</span>
    <span class="n">one_sided</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">upper</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">lower</span><span class="p">:</span>
        <span class="n">one_sided</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">zscores</span> <span class="o">=</span> <span class="n">best_fit_z_scores</span><span class="p">(</span><span class="n">fit_results</span><span class="p">,</span> <span class="n">fitted_dist_p_value</span><span class="o">=</span><span class="n">zscores_pvalue</span><span class="p">,</span> <span class="n">onesided</span><span class="o">=</span><span class="n">one_sided</span><span class="p">,</span>
                                <span class="n">upper_pvalue</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>

    <span class="n">output_results</span><span class="p">(</span><span class="n">fit_results</span><span class="p">,</span> <span class="n">zscores</span><span class="p">,</span> <span class="n">one_sided</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">noheader</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">noheader</span><span class="p">,</span>
                   <span class="n">verbose_mode</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_gof</span><span class="o">=</span><span class="n">results_all</span><span class="p">)</span>
    
    <span class="c1"># ------------</span>
    <span class="c1"># END OF FILE</span>
    <span class="c1"># ------------</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">fitdist 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Al Reich.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>